container_commands:
  01_migrate:
    command: |
      source /var/app/venv/*/bin/activate
      cd /var/app/current
      python manage.py migrate --noinput
    leader_only: true
  02_collectstatic:
    command: |
      source /var/app/venv/*/bin/activate
      cd /var/app/current
      python manage.py collectstatic --noinput
    leader_only: true
  03_populate_zip_codes:
    command: |
      source /var/app/venv/*/bin/activate
      cd /var/app/current
      # Populate regional center ZIP codes for proper boundary lookups
      python manage.py populate_san_gabriel_zips || echo "San Gabriel ZIP population failed or skipped"
      python manage.py populate_pasadena_zips || echo "Pasadena ZIP population failed or skipped"
    leader_only: true
  04_import_providers:
    command: |
      source /var/app/venv/*/bin/activate
      cd /var/app/current
      # Import Pasadena providers (will skip if already exist due to update_or_create)
      python manage.py import_regional_center_providers --file "data/Pasadena Provider List.xlsx" --area "Pasadena" || echo "Pasadena import failed or skipped"
      # Import San Gabriel providers
      python manage.py import_regional_center_providers --file "data/San Gabriel Pomona Provider List.xlsx" --regional-center "San Gabriel" || echo "San Gabriel import failed or skipped"
    leader_only: true

option_settings:
  aws:elasticbeanstalk:application:environment:
    DJANGO_SETTINGS_MODULE: maplocation.settings
  aws:elasticbeanstalk:container:python:
    WSGIPath: maplocation.wsgi:application
