#!/usr/bin/env python3
"""
Populate Los Angeles ZIP codes for regional centers.
This script maps all LA County ZIP codes to their appropriate regional centers.
"""

import os
import sys
import django

# Setup Django
sys.path.append(os.path.dirname(os.path.abspath(__file__)))
os.environ.setdefault("DJANGO_SETTINGS_MODULE", "maplocation.settings")
django.setup()

from locations.models import RegionalCenter


def populate_la_zip_codes():
    """Populate ZIP codes for Los Angeles County regional centers"""

    # Los Angeles County ZIP code ranges by regional center
    la_zip_mapping = {
        "Frank D. Lanterman Regional Center": [
            # Central LA area
            "90001",
            "90002",
            "90003",
            "90004",
            "90005",
            "90006",
            "90007",
            "90008",
            "90009",
            "90010",
            "90011",
            "90012",
            "90013",
            "90014",
            "90015",
            "90016",
            "90017",
            "90018",
            "90019",
            "90020",
            "90021",
            "90022",
            "90023",
            "90024",
            "90025",
            "90026",
            "90027",
            "90028",
            "90029",
            "90030",
            "90031",
            "90032",
            "90033",
            "90034",
            "90035",
            "90036",
            "90037",
            "90038",
            "90039",
            "90040",
            "90041",
            "90042",
            "90043",
            "90044",
            "90045",
            "90046",
            "90047",
            "90048",
            "90049",
            "90050",
            "90051",
            "90052",
            "90053",
            "90054",
            "90055",
            "90056",
            "90057",
            "90058",
            "90059",
            "90060",
            "90061",
            "90062",
            "90063",
            "90064",
            "90065",
            "90066",
            "90067",
            "90068",
            "90069",
            "90070",
            "90071",
            "90072",
            "90073",
            "90074",
            "90075",
            "90076",
            "90077",
            "90078",
            "90079",
            "90080",
            "90081",
            "90082",
            "90083",
            "90084",
            "90085",
            "90086",
            "90087",
            "90088",
            "90089",
            "90090",
            "90091",
            "90092",
            "90093",
            "90094",
            "90095",
            "90096",
            "90097",
            "90098",
            "90099",
            # Additional central LA ZIPs
            "90210",
            "90211",
            "90212",
            "90213",
            "90214",
            "90215",
            "90216",
            "90217",
            "90218",
            "90219",
            "90220",
            "90221",
            "90222",
            "90223",
            "90224",
            "90225",
            "90226",
            "90227",
            "90228",
            "90229",
            "90230",
            "90231",
            "90232",
            "90233",
            "90234",
            "90235",
            "90236",
            "90237",
            "90238",
            "90239",
            "90240",
            "90241",
            "90242",
            "90243",
            "90244",
            "90245",
            "90246",
            "90247",
            "90248",
            "90249",
            "90250",
            "90251",
            "90252",
            "90253",
            "90254",
            "90255",
            "90256",
            "90257",
            "90258",
            "90259",
            "90260",
            "90261",
            "90262",
            "90263",
            "90264",
            "90265",
            "90266",
            "90267",
            "90268",
            "90269",
            "90270",
            "90271",
            "90272",
            "90273",
            "90274",
            "90275",
            "90276",
            "90277",
            "90278",
            "90279",
            "90280",
            "90281",
            "90282",
            "90283",
            "90284",
            "90285",
            "90286",
            "90287",
            "90288",
            "90289",
            "90290",
            "90291",
            "90292",
            "90293",
            "90294",
            "90295",
            "90296",
            "90297",
            "90298",
            "90299",
        ],
        "North Los Angeles County Regional Center": [
            # San Fernando Valley
            "91301",
            "91302",
            "91303",
            "91304",
            "91305",
            "91306",
            "91307",
            "91308",
            "91309",
            "91310",
            "91311",
            "91312",
            "91313",
            "91314",
            "91315",
            "91316",
            "91317",
            "91318",
            "91319",
            "91320",
            "91321",
            "91322",
            "91323",
            "91324",
            "91325",
            "91326",
            "91327",
            "91328",
            "91329",
            "91330",
            "91331",
            "91332",
            "91333",
            "91334",
            "91335",
            "91336",
            "91337",
            "91338",
            "91339",
            "91340",
            "91341",
            "91342",
            "91343",
            "91344",
            "91345",
            "91346",
            "91347",
            "91348",
            "91349",
            "91350",
            "91351",
            "91352",
            "91353",
            "91354",
            "91355",
            "91356",
            "91357",
            "91358",
            "91359",
            "91360",
            "91361",
            "91362",
            "91363",
            "91364",
            "91365",
            "91366",
            "91367",
            "91368",
            "91369",
            "91370",
            "91371",
            "91372",
            "91373",
            "91374",
            "91375",
            "91376",
            "91377",
            "91378",
            "91379",
            "91380",
            "91381",
            "91382",
            "91383",
            "91384",
            "91385",
            "91386",
            "91387",
            "91388",
            "91389",
            "91390",
            "91391",
            "91392",
            "91393",
            "91394",
            "91395",
            "91396",
            "91397",
            "91398",
            "91399",
        ],
        "Eastern Los Angeles Regional Center": [
            # East LA, San Gabriel Valley
            "91701",
            "91702",
            "91703",
            "91704",
            "91705",
            "91706",
            "91707",
            "91708",
            "91709",
            "91710",
            "91711",
            "91712",
            "91713",
            "91714",
            "91715",
            "91716",
            "91717",
            "91718",
            "91719",
            "91720",
            "91721",
            "91722",
            "91723",
            "91724",
            "91725",
            "91726",
            "91727",
            "91728",
            "91729",
            "91730",
            "91731",
            "91732",
            "91733",
            "91734",
            "91735",
            "91736",
            "91737",
            "91738",
            "91739",
            "91740",
            "91741",
            "91742",
            "91743",
            "91744",
            "91745",
            "91746",
            "91747",
            "91748",
            "91749",
            "91750",
            "91751",
            "91752",
            "91753",
            "91754",
            "91755",
            "91756",
            "91757",
            "91758",
            "91759",
            "91760",
            "91761",
            "91762",
            "91763",
            "91764",
            "91765",
            "91766",
            "91767",
            "91768",
            "91769",
            "91770",
            "91771",
            "91772",
            "91773",
            "91774",
            "91775",
            "91776",
            "91777",
            "91778",
            "91779",
            "91780",
            "91781",
            "91782",
            "91783",
            "91784",
            "91785",
            "91786",
            "91787",
            "91788",
            "91789",
            "91790",
            "91791",
            "91792",
            "91793",
            "91794",
            "91795",
            "91796",
            "91797",
            "91798",
            "91799",
            # Additional East LA ZIPs
            "91801",
            "91802",
            "91803",
            "91804",
            "91805",
            "91806",
            "91807",
            "91808",
            "91809",
            "91810",
            "91811",
            "91812",
            "91813",
            "91814",
            "91815",
            "91816",
            "91817",
            "91818",
            "91819",
            "91820",
            "91821",
            "91822",
            "91823",
            "91824",
            "91825",
            "91826",
            "91827",
            "91828",
            "91829",
            "91830",
            "91831",
            "91832",
            "91833",
            "91834",
            "91835",
            "91836",
            "91837",
            "91838",
            "91839",
            "91840",
            "91841",
            "91842",
            "91843",
            "91844",
            "91845",
            "91846",
            "91847",
            "91848",
            "91849",
            "91850",
            "91851",
            "91852",
            "91853",
            "91854",
            "91855",
            "91856",
            "91857",
            "91858",
            "91859",
            "91860",
            "91861",
            "91862",
            "91863",
            "91864",
            "91865",
            "91866",
            "91867",
            "91868",
            "91869",
            "91870",
            "91871",
            "91872",
            "91873",
            "91874",
            "91875",
            "91876",
            "91877",
            "91878",
            "91879",
            "91880",
            "91881",
            "91882",
            "91883",
            "91884",
            "91885",
            "91886",
            "91887",
            "91888",
            "91889",
            "91890",
            "91891",
            "91892",
            "91893",
            "91894",
            "91895",
            "91896",
            "91897",
            "91898",
            "91899",
        ],
        "San Gabriel/Pomona Regional Center": [
            # San Gabriel Valley, Pomona area
            "91750",
            "91751",
            "91752",
            "91753",
            "91754",
            "91755",
            "91756",
            "91757",
            "91758",
            "91759",
            "91760",
            "91761",
            "91762",
            "91763",
            "91764",
            "91765",
            "91766",
            "91767",
            "91768",
            "91769",
            "91770",
            "91771",
            "91772",
            "91773",
            "91774",
            "91775",
            "91776",
            "91777",
            "91778",
            "91779",
            "91780",
            "91781",
            "91782",
            "91783",
            "91784",
            "91785",
            "91786",
            "91787",
            "91788",
            "91789",
            "91790",
            "91791",
            "91792",
            "91793",
            "91794",
            "91795",
            "91796",
            "91797",
            "91798",
            "91799",
        ],
        "Harbor Regional Center": [
            # South Bay, Harbor area
            "90501",
            "90502",
            "90503",
            "90504",
            "90505",
            "90506",
            "90507",
            "90508",
            "90509",
            "90510",
            "90511",
            "90512",
            "90513",
            "90514",
            "90515",
            "90516",
            "90517",
            "90518",
            "90519",
            "90520",
            "90521",
            "90522",
            "90523",
            "90524",
            "90525",
            "90526",
            "90527",
            "90528",
            "90529",
            "90530",
            "90531",
            "90532",
            "90533",
            "90534",
            "90535",
            "90536",
            "90537",
            "90538",
            "90539",
            "90540",
            "90541",
            "90542",
            "90543",
            "90544",
            "90545",
            "90546",
            "90547",
            "90548",
            "90549",
            "90550",
            "90551",
            "90552",
            "90553",
            "90554",
            "90555",
            "90556",
            "90557",
            "90558",
            "90559",
            "90560",
            "90561",
            "90562",
            "90563",
            "90564",
            "90565",
            "90566",
            "90567",
            "90568",
            "90569",
            "90570",
            "90571",
            "90572",
            "90573",
            "90574",
            "90575",
            "90576",
            "90577",
            "90578",
            "90579",
            "90580",
            "90581",
            "90582",
            "90583",
            "90584",
            "90585",
            "90586",
            "90587",
            "90588",
            "90589",
            "90590",
            "90591",
            "90592",
            "90593",
            "90594",
            "90595",
            "90596",
            "90597",
            "90598",
            "90599",
        ],
        "South Central Los Angeles Regional Center": [
            # South LA area
            "90001",
            "90002",
            "90003",
            "90004",
            "90005",
            "90006",
            "90007",
            "90008",
            "90009",
            "90010",
            "90011",
            "90012",
            "90013",
            "90014",
            "90015",
            "90016",
            "90017",
            "90018",
            "90019",
            "90020",
            "90021",
            "90022",
            "90023",
            "90024",
            "90025",
            "90026",
            "90027",
            "90028",
            "90029",
            "90030",
            "90031",
            "90032",
            "90033",
            "90034",
            "90035",
            "90036",
            "90037",
            "90038",
            "90039",
            "90040",
            "90041",
            "90042",
            "90043",
            "90044",
            "90045",
            "90046",
            "90047",
            "90048",
            "90049",
            "90050",
            "90051",
            "90052",
            "90053",
            "90054",
            "90055",
            "90056",
            "90057",
            "90058",
            "90059",
            "90060",
            "90061",
            "90062",
            "90063",
            "90064",
            "90065",
            "90066",
            "90067",
            "90068",
            "90069",
            "90070",
            "90071",
            "90072",
            "90073",
            "90074",
            "90075",
            "90076",
            "90077",
            "90078",
            "90079",
            "90080",
            "90081",
            "90082",
            "90083",
            "90084",
            "90085",
            "90086",
            "90087",
            "90088",
            "90089",
            "90090",
            "90091",
            "90092",
            "90093",
            "90094",
            "90095",
            "90096",
            "90097",
            "90098",
            "90099",
        ],
        "Westside Regional Center": [
            # West LA, Santa Monica, Culver City
            "90210",
            "90211",
            "90212",
            "90213",
            "90214",
            "90215",
            "90216",
            "90217",
            "90218",
            "90219",
            "90220",
            "90221",
            "90222",
            "90223",
            "90224",
            "90225",
            "90226",
            "90227",
            "90228",
            "90229",
            "90230",
            "90231",
            "90232",
            "90233",
            "90234",
            "90235",
            "90236",
            "90237",
            "90238",
            "90239",
            "90240",
            "90241",
            "90242",
            "90243",
            "90244",
            "90245",
            "90246",
            "90247",
            "90248",
            "90249",
            "90250",
            "90251",
            "90252",
            "90253",
            "90254",
            "90255",
            "90256",
            "90257",
            "90258",
            "90259",
            "90260",
            "90261",
            "90262",
            "90263",
            "90264",
            "90265",
            "90266",
            "90267",
            "90268",
            "90269",
            "90270",
            "90271",
            "90272",
            "90273",
            "90274",
            "90275",
            "90276",
            "90277",
            "90278",
            "90279",
            "90280",
            "90281",
            "90282",
            "90283",
            "90284",
            "90285",
            "90286",
            "90287",
            "90288",
            "90289",
            "90290",
            "90291",
            "90292",
            "90293",
            "90294",
            "90295",
            "90296",
            "90297",
            "90298",
            "90299",
            # Additional Westside ZIPs
            "90401",
            "90402",
            "90403",
            "90404",
            "90405",
            "90406",
            "90407",
            "90408",
            "90409",
            "90410",
            "90411",
            "90412",
            "90413",
            "90414",
            "90415",
            "90416",
            "90417",
            "90418",
            "90419",
            "90420",
            "90421",
            "90422",
            "90423",
            "90424",
            "90425",
            "90426",
            "90427",
            "90428",
            "90429",
            "90430",
            "90431",
            "90432",
            "90433",
            "90434",
            "90435",
            "90436",
            "90437",
            "90438",
            "90439",
            "90440",
            "90441",
            "90442",
            "90443",
            "90444",
            "90445",
            "90446",
            "90447",
            "90448",
            "90449",
            "90450",
            "90451",
            "90452",
            "90453",
            "90454",
            "90455",
            "90456",
            "90457",
            "90458",
            "90459",
            "90460",
            "90461",
            "90462",
            "90463",
            "90464",
            "90465",
            "90466",
            "90467",
            "90468",
            "90469",
            "90470",
            "90471",
            "90472",
            "90473",
            "90474",
            "90475",
            "90476",
            "90477",
            "90478",
            "90479",
            "90480",
            "90481",
            "90482",
            "90483",
            "90484",
            "90485",
            "90486",
            "90487",
            "90488",
            "90489",
            "90490",
            "90491",
            "90492",
            "90493",
            "90494",
            "90495",
            "90496",
            "90497",
            "90498",
            "90499",
        ],
    }

    print("🗺️  Populating Los Angeles ZIP codes for regional centers...")

    total_updated = 0

    for regional_center_name, zip_codes in la_zip_mapping.items():
        try:
            # Find the regional center
            center = RegionalCenter.objects.filter(
                regional_center=regional_center_name, county_served="Los Angeles"
            ).first()

            if center:
                # Update the zip_codes field
                center.zip_codes = zip_codes
                center.save()
                print(f"✅ Updated {regional_center_name}: {len(zip_codes)} ZIP codes")
                total_updated += len(zip_codes)
            else:
                print(f"❌ Regional center not found: {regional_center_name}")

        except Exception as e:
            print(f"❌ Error updating {regional_center_name}: {e}")

    print(f"\n🎉 Successfully updated {total_updated} ZIP code mappings!")

    # Test a few ZIP codes
    test_zips = ["91403", "90001", "90210", "91766", "90503"]
    print(f"\n🧪 Testing ZIP code lookups:")
    for zip_code in test_zips:
        center = RegionalCenter.find_by_zip_code(zip_code)
        if center:
            print(f"  {zip_code}: {center.regional_center}")
        else:
            print(f"  {zip_code}: Not found")


if __name__ == "__main__":
    populate_la_zip_codes()
